<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper 
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.project.springboot.dao.IUserDAO">

    <select id="findById" resultType="com.project.springboot.dto.UserDTO">
        SELECT * FROM "USER" WHERE u_id = #{uId, jdbcType=VARCHAR}
    </select>

    <insert id="insertUser" parameterType="com.project.springboot.dto.UserDTO">
        INSERT INTO "USER" (
            u_no, u_id, u_password, u_signup_step, u_social_type, u_email_verified, u_create_at, u_auth
        ) VALUES (
            USER_SEQ.NEXTVAL,
            #{uId, jdbcType=VARCHAR},
            #{uPassword, jdbcType=VARCHAR},
            #{uSignupStep, jdbcType=INTEGER},
            #{uSocialType, jdbcType=VARCHAR},
            'N', SYSDATE,
            'user'
        )
    </insert>

    <update id="updateUserStep2" parameterType="com.project.springboot.dto.UserDTO">
        UPDATE "USER"
        SET u_nick = #{uNick, jdbcType=VARCHAR},
            u_gender = #{uGender, jdbcType=VARCHAR},
            u_birth = #{uBirth, jdbcType=DATE},
            u_region = #{uRegion, jdbcType=VARCHAR}
        WHERE u_id = #{uId, jdbcType=VARCHAR}
    </update>

    <update id="updateEmailVerification">
        UPDATE "USER" SET u_email_verified = 'Y' WHERE u_id = #{uId, jdbcType=VARCHAR}
    </update>
    
<!--닉네임 중복확인-->
<select id="countByNick" resultType="int">
	SELECT COUNT(*) FROM "USER" WHERE u_nick = #{uNick, jdbcType=VARCHAR}
</select>

</mapper>